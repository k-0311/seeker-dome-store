!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.KMmonitor=t():e.KMmonitor=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){var r=n(6),o=n(1);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?o(e):t}},function(e,t,n){var r=n(9);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){n(0);var r=n(10);function o(t,n,i){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=o=Reflect.get:e.exports=o=function(e,t,n){var o=r(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(n):i.value}},o(t,n,i||t)}e.exports=o},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=r=function(e){return n(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},r(t)}e.exports=r},function(e,t,n){"use strict";var r=n(11),o=n(12),i=(navigator.userAgent||"")+" "+(navigator.appVersion||"")+" "+(navigator.vendor||""),a=new r(o);function s(e){var t=a.parse(e),n=function(e){if(!o.re_msie.test(e))return null;var t,n,r=void 0,i=void 0,a=void 0;if(-1!==e.indexOf("trident/")&&(r=/\btrident\/([0-9.]+)/.exec(e))&&r.length>=2){i=r[1];var s=r[1].split(".");s[0]=parseInt(s[0],10)+4,a=s.join(".")}n=(r=o.re_msie.exec(e))[1];var c=r[1].split(".");return void 0===a&&(a=n),c[0]=parseInt(c[0],10)-4,t=c.join("."),void 0===i&&(i=t),{browserVersion:a,browserMode:n,engineVersion:i,engineMode:t,compatible:i!==t}}(e);if(n){var r=t.engine.name,i=n.engineVersion||n.engineMode,s=parseFloat(i),c=n.engineMode;t.engine={name:r,version:s,fullVersion:i,mode:parseFloat(c),fullMode:c,compatible:!!n&&n.compatible},t.engine[t.engine.name]=s;var u=t.browser.name,l=t.browser.fullVersion;"ie"===u&&(l=n.browserVersion);var p=n.browserMode,f=parseFloat(l);t.browser={name:u,version:f,fullVersion:l,mode:parseFloat(p),fullMode:p,compatible:!!n&&n.compatible},t.browser[u]=f}return t}var c=s(i);c.parse=s,e.exports=c},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){var r=n(0);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o="-1",i={name:"na",version:o};function a(e){return function(t){return Object.prototype.toString.call(t)==="[object "+e+"]"}}var s=a("String"),c=a("RegExp"),u=a("Object"),l=a("Function");function p(e,t,n,r){var a=i;!function(e,t){for(var n=0,r=e.length;n<r&&!1!==t.call(e,e[n],n);n++);}(t,function(t){var n=function(e,t,n){var r=l(t)?t.call(null,n):t;if(!r)return null;var i={name:e,version:o,codename:""};if(!0===r)return i;if(s(r)){if(-1!==n.indexOf(r))return i}else{if(u(r))return r.hasOwnProperty("version")&&(i.version=r.version),i;if(c(r)){var a=r.exec(n);if(a)return a.length>=2&&a[1]?i.version=a[1].replace(/_/g,"."):i.version=o,i}}}(t[0],t[1],e);if(n)return a=n,!1}),n.call(r,a.name,a.version)}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._rules=t}return r(e,[{key:"parse",value:function(e){e=(e||"").toLowerCase();var t={};p(e,this._rules.device,function(e,n){var r=parseFloat(n);t.device={name:e,version:r,fullVersion:n},t.device[e]=r},t),p(e,this._rules.os,function(e,n){var r=parseFloat(n);t.os={name:e,version:r,fullVersion:n},t.os[e]=r},t);var n=this.IEMode(e);return p(e,this._rules.engine,function(e,r){var o=r;n&&(r=n.engineVersion||n.engineMode,o=n.engineMode);var i=parseFloat(r);t.engine={name:e,version:i,fullVersion:r,mode:parseFloat(o),fullMode:o,compatible:!!n&&n.compatible},t.engine[e]=i},t),p(e,this._rules.browser,function(e,r){var o=r;n&&("ie"===e&&(r=n.browserVersion),o=n.browserMode);var i=parseFloat(r);t.browser={name:e,version:i,fullVersion:r,mode:parseFloat(o),fullMode:o,compatible:!!n&&n.compatible},t.browser[e]=i},t),t}},{key:"IEMode",value:function(e){if(!this._rules.re_msie.test(e))return null;var t,n,r=void 0,o=void 0,i=void 0;if(-1!==e.indexOf("trident/")&&(r=/\btrident\/([0-9.]+)/.exec(e))&&r.length>=2){o=r[1];var a=r[1].split(".");a[0]=parseInt(a[0],10)+4,i=a.join(".")}n=(r=this._rules.re_msie.exec(e))[1];var s=r[1].split(".");return void 0===i&&(i=n),s[0]=parseInt(s[0],10)-4,t=s.join("."),void 0===o&&(o=t),{browserVersion:i,browserMode:n,engineVersion:o,engineMode:t,compatible:o!==t}}}]),e}();e.exports=f},function(e,t,n){"use strict";(function(t){var n="undefined"==typeof window?t:window,r=n.external,o=/\b(?:msie |ie |trident\/[0-9].*rv[ :])([0-9.]+)/,i=/\bbb10\b.+?\bversion\/([\d.]+)/,a=/\bblackberry\b.+\bversion\/([\d.]+)/,s=/\bblackberry\d+\/([\d.]+)/,c=[["wp",function(e){return-1!==e.indexOf("windows phone ")?/\bwindows phone (?:os )?([0-9.]+)/:-1!==e.indexOf("xblwp")?/\bxblwp([0-9.]+)/:-1!==e.indexOf("zunewp")?/\bzunewp([0-9.]+)/:"windows phone"}],["windows",/\bwindows nt ([0-9.]+)/],["macosx",/\bmac os x ([0-9._]+)/],["ios",function(e){return/\bcpu(?: iphone)? os /.test(e)?/\bcpu(?: iphone)? os ([0-9._]+)/:-1!==e.indexOf("iph os ")?/\biph os ([0-9_]+)/:/\bios\b/}],["yunos",/\baliyunos ([0-9.]+)/],["android",function(e){return e.indexOf("android")>=0?/\bandroid[ \/-]?([0-9.x]+)?/:e.indexOf("adr")>=0?e.indexOf("mqqbrowser")>=0?/\badr[ ]\(linux; u; ([0-9.]+)?/:/\badr(?:[ ]([0-9.]+))?/:"android"}],["chromeos",/\bcros i686 ([0-9.]+)/],["linux","linux"],["windowsce",/\bwindows ce(?: ([0-9.]+))?/],["symbian",/\bsymbian(?:os)?\/([0-9.]+)/],["blackberry",function(e){var t=e.match(i)||e.match(a)||e.match(s);return t?{version:t[1]}:"blackberry"}]];function u(e){if(r)try{var t=r.twGetRunPath.toLowerCase(),o=r.twGetSecurityID(n),i=r.twGetVersion(o);if(t&&-1===t.indexOf(e))return!1;if(i)return{version:i}}catch(e){}}var l=[["edgehtml",/edge\/([0-9.]+)/],["trident",o],["blink",function(){return"chrome"in n&&"CSS"in n&&/\bapplewebkit[\/]?([0-9.+]+)/}],["webkit",/\bapplewebkit[\/]?([0-9.+]+)/],["gecko",function(e){var t=e.match(/\brv:([\d\w.]+).*\bgecko\/(\d+)/);if(t)return{version:t[1]+"."+t[2]}}],["presto",/\bpresto\/([0-9.]+)/],["androidwebkit",/\bandroidwebkit\/([0-9.]+)/],["coolpadwebkit",/\bcoolpadwebkit\/([0-9.]+)/],["u2",/\bu2\/([0-9.]+)/],["u3",/\bu3\/([0-9.]+)/]],p=[["edge",/edge\/([0-9.]+)/],["sogou",function(e){return e.indexOf("sogoumobilebrowser")>=0?/sogoumobilebrowser\/([0-9.]+)/:e.indexOf("sogoumse")>=0||/ se ([0-9.x]+)/}],["theworld",function(){var e=u("theworld");return void 0!==e?e:/theworld(?: ([\d.])+)?/}],["360",function(e){var t=u("360se");return void 0!==t?t:-1!==e.indexOf("360 aphone browser")?/\b360 aphone browser \(([^\)]+)\)/:/\b360(?:se|ee|chrome|browser)\b/}],["maxthon",function(){try{if(r&&(r.mxVersion||r.max_version))return{version:r.mxVersion||r.max_version}}catch(e){}return/\b(?:maxthon|mxbrowser)(?:[ \/]([0-9.]+))?/}],["micromessenger",/\bmicromessenger\/([\d.]+)/],["qq",/\bm?qqbrowser\/([0-9.]+)/],["green","greenbrowser"],["tt",/\btencenttraveler ([0-9.]+)/],["liebao",function(e){if(e.indexOf("liebaofast")>=0)return/\bliebaofast\/([0-9.]+)/;if(-1===e.indexOf("lbbrowser"))return!1;var t=void 0;try{r&&r.LiebaoGetVersion&&(t=r.LiebaoGetVersion())}catch(e){}return{version:t||"-1"}}],["tao",/\btaobrowser\/([0-9.]+)/],["coolnovo",/\bcoolnovo\/([0-9.]+)/],["saayaa","saayaa"],["baidu",/\b(?:ba?idubrowser|baiduhd)[ \/]([0-9.x]+)/],["ie",o],["mi",/\bmiuibrowser\/([0-9.]+)/],["opera",function(e){var t=/\bopera.+version\/([0-9.ab]+)/;return t.test(e)?t:/\bopr\/([0-9.]+)/}],["oupeng",/\boupeng\/([0-9.]+)/],["yandex",/yabrowser\/([0-9.]+)/],["ali-ap",function(e){return e.indexOf("aliapp")>0?/\baliapp\(ap\/([0-9.]+)\)/:/\balipayclient\/([0-9.]+)\b/}],["ali-ap-pd",/\baliapp\(ap-pd\/([0-9.]+)\)/],["ali-am",/\baliapp\(am\/([0-9.]+)\)/],["ali-tb",/\baliapp\(tb\/([0-9.]+)\)/],["ali-tb-pd",/\baliapp\(tb-pd\/([0-9.]+)\)/],["ali-tm",/\baliapp\(tm\/([0-9.]+)\)/],["ali-tm-pd",/\baliapp\(tm-pd\/([0-9.]+)\)/],["uc",function(e){return e.indexOf("ucbrowser/")>=0?/\bucbrowser\/([0-9.]+)/:e.indexOf("ubrowser/")>=0?/\bubrowser\/([0-9.]+)/:/\buc\/[0-9]/.test(e)?/\buc\/([0-9.]+)/:e.indexOf("ucweb")>=0?/\bucweb([0-9.]+)?/:/\b(?:ucbrowser|uc)\b/}],["chrome",/ (?:chrome|crios|crmo)\/([0-9.]+)/],["android",function(e){if(-1!==e.indexOf("android"))return/\bversion\/([0-9.]+(?: beta)?)/}],["blackberry",function(e){var t=e.match(i)||e.match(a)||e.match(s);return t?{version:t[1]}:"blackberry"}],["safari",/\bversion\/([0-9.]+(?: beta)?)(?: mobile(?:\/[a-z0-9]+)?)? safari\//],["webview",/\bcpu(?: iphone)? os (?:[0-9._]+).+\bapplewebkit\b/],["firefox",/\bfirefox\/([0-9.ab]+)/],["nokia",/\bnokiabrowser\/([0-9.]+)/]];e.exports={device:[["nokia",function(e){return-1!==e.indexOf("nokia ")?/\bnokia ([0-9]+)?/:/\bnokia([a-z0-9]+)?/}],["samsung",function(e){return-1!==e.indexOf("samsung")?/\bsamsung(?:[ \-](?:sgh|gt|sm))?-([a-z0-9]+)/:/\b(?:sgh|sch|gt|sm)-([a-z0-9]+)/}],["wp",function(e){return-1!==e.indexOf("windows phone ")||-1!==e.indexOf("xblwp")||-1!==e.indexOf("zunewp")||-1!==e.indexOf("windows ce")}],["pc","windows"],["ipad","ipad"],["ipod","ipod"],["iphone",/\biphone\b|\biph(\d)/],["mac","macintosh"],["mi",/\bmi[ \-]?([a-z0-9 ]+(?= build|\)))/],["hongmi",/\bhm[ \-]?([a-z0-9]+)/],["aliyun",/\baliyunos\b(?:[\-](\d+))?/],["meizu",function(e){return e.indexOf("meizu")>=0?/\bmeizu[\/ ]([a-z0-9]+)\b/:/\bm([0-9cx]{1,4})\b/}],["nexus",/\bnexus ([0-9s.]+)/],["huawei",function(e){var t=/\bmediapad (.+?)(?= build\/huaweimediapad\b)/;return-1!==e.indexOf("huawei-huawei")?/\bhuawei\-huawei\-([a-z0-9\-]+)/:t.test(e)?t:/\bhuawei[ _\-]?([a-z0-9]+)/}],["lenovo",function(e){return-1!==e.indexOf("lenovo-lenovo")?/\blenovo\-lenovo[ \-]([a-z0-9]+)/:/\blenovo[ \-]?([a-z0-9]+)/}],["zte",function(e){return/\bzte\-[tu]/.test(e)?/\bzte-[tu][ _\-]?([a-su-z0-9\+]+)/:/\bzte[ _\-]?([a-su-z0-9\+]+)/}],["vivo",/\bvivo(?: ([a-z0-9]+))?/],["htc",function(e){return/\bhtc[a-z0-9 _\-]+(?= build\b)/.test(e)?/\bhtc[ _\-]?([a-z0-9 ]+(?= build))/:/\bhtc[ _\-]?([a-z0-9 ]+)/}],["oppo",/\boppo[_]([a-z0-9]+)/],["konka",/\bkonka[_\-]([a-z0-9]+)/],["sonyericsson",/\bmt([a-z0-9]+)/],["coolpad",/\bcoolpad[_ ]?([a-z0-9]+)/],["lg",/\blg[\-]([a-z0-9]+)/],["android",/\bandroid\b|\badr\b/],["blackberry",function(e){return e.indexOf("blackberry")>=0?/\bblackberry\s?(\d+)/:"bb10"}]],os:c,browser:p,engine:l,re_msie:o}}).call(this,n(13))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t);var r=n(6),o=n.n(r),i=n(2),a=n.n(i),s=n(3),c=n.n(s),u=n(1),l=n.n(u),p=n(4),f=n.n(p),d=n(0),b=n.n(d),m=n(5),v=n.n(m),h=n(8),g=n.n(h),w=-1===window.location.href.indexOf("https")?"http://":"https://",y=window.location.href,O=(y.indexOf("localhost"),window.navigator.userAgent,localStorage.kmUserInfo&&JSON.parse(localStorage.kmUserInfo),function(){function e(){a()(this,e)}return g()(e,[{key:"handleLogInfo",value:function(e,t){switch(e){case"ELE_BEHAVIOR":localStorage.ELE_BEHAVIOR=JSON.stringify(t);break;case"JS_ERROR":localStorage.JS_ERROR=JSON.stringify(t);break;case"HTTP_LOG":localStorage.HTTP_LOG=JSON.stringify(t);break;case"SCREEN_SHOT":localStorage.SCREEN_SHOT=JSON.stringify(t);break;case"CUSTOMER_PV":localStorage.CUSTOMER_PV=JSON.stringify(t);break;case"LOAD_PAGE":localStorage.LOAD_PAGE=JSON.stringify(t);break;case"RESOURCE_LOAD":localStorage.RESOURCE_LOAD=JSON.stringify(t);break;case"CUSTOMIZE_BEHAVIOR":localStorage.CUSTOMIZE_BEHAVIOR=JSON.stringify(t)}}},{key:"setCommonProperty",value:function(){this.happenTime=(new Date).getTime(),this.WebMonitorId="km_webmonitor",this.simpleUrl=window.location.href.split("?")[0].replace("#","")}}]),e}());function x(){var e=(new Date).getTime();return"xxxxxxxx".replace(/[xy]/g,function(t){var n=16*Math.random()|0;return("x"==t?n:3&n|8).toString(16)+"-"+e})}function E(){var e=x();return localStorage.monitorPageKey||(localStorage.monitorPageKey=e),localStorage.monitorPageKey}function S(e){try{return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))}catch(t){return e}}function R(e,t){if(0===arguments.length)return null;var n,r=t||"{y}-{m}-{d} {h}:{i}:{s}";10===(""+e).length&&(e=1e3*parseInt(e));var o={y:(n=new Date(e)).getFullYear(),m:n.getMonth()+1,d:n.getDate(),h:n.getHours(),i:n.getMinutes(),s:n.getSeconds(),a:n.getDay()};return r.replace(/{(y|m|d|h|i|s|a)+}/g,function(e,t){var n=o[t];return"a"===t?["日","一","二","三","四","五","六"][n]:(e.length>0&&n<10&&(n="0"+n),n||0)})}var _=n(7),T=function(e){function t(e,n,r,o){var i;return a()(this,t),i=c()(this,b()(t).call(this)),v()(b()(t.prototype),"setCommonProperty",l()(i)).call(l()(i)),i.uploadType=e,i.infoType=n,i.pageKey=E(),i.deviceName=_.device.name,i.os=_.os.name+" "+_.os.version,i.browserName=_.browser.name,i.browserVersion=_.browser.version,i.monitorIp="",i.country="china",i.province="",i.city="",i.detail=r,i}return f()(t,e),t}(O),k=function(e){function t(e,n,r,o){var i;return a()(this,t),i=c()(this,b()(t).call(this)),v()(b()(t.prototype),"setCommonProperty",l()(i)).call(l()(i)),i.uploadType=e,i.elementType=r,i.detail=n,i.status=o,i}return f()(t,e),t}(O),L=n(7),j=function(e){function t(e,n,r){var o;return a()(this,t),o=c()(this,b()(t).call(this)),v()(b()(t.prototype),"setCommonProperty",l()(o)).call(l()(o)),o.uploadType=e,o.pageKey=E(),o.deviceName=L.device.name,o.os=L.os.name+" "+L.os.version,o.browserName=L.browser.name,o.browserVersion=L.browser.version,o.monitorIp="",o.country="china",o.province="",o.city="",o.loadType=n,o.loadTime=r,o}return f()(t,e),t}(O),C=function(e){function t(e,n,r,o,i,s,u,p,f,d,m,h){var g;return a()(this,t),g=c()(this,b()(t).call(this)),v()(b()(t.prototype),"setCommonProperty",l()(g)).apply(l()(g)),g.uploadType=e,g.loadType=n,g.loadPage=r,g.domReady=o,g.redirect=i,g.lookupDomain=s,g.ttfb=u,g.request=p,g.loadEvent=f,g.appcache=d,g.unloadEvent=m,g.connect=h,g}return f()(t,e),t}(O),M=function(e){function t(e,n,r,o,i,s,u){var p;return a()(this,t),p=c()(this,b()(t).call(this)),v()(b()(t.prototype),"setCommonProperty",l()(p)).call(l()(p)),p.uploadType=e,p.behaviorType=n,p.className=S(r),p.placeholder=S(o),p.inputValue=S(i),p.tagName=s,p.innerText=S(encodeURIComponent(u)),p}return f()(t,e),t}(O),P=function(e){function t(e,n,r,o,i,s,u){var p;return a()(this,t),p=c()(this,b()(t).call(this)),v()(b()(t.prototype),"setCommonProperty",l()(p)).call(l()(p)),p.uploadType=e,p.httpUrl=S(encodeURIComponent(n)),p.status=r,p.statusText=o,p.statusResult=i,p.happenTime=s,p.loadTime=u,p}return f()(t,e),t}(O);t.default={recordResourceError:function(){window.addEventListener("error",function(e){if(!e.message||"ResizeObserver loop limit exceeded"!==e.message){var t=e.target.localName,n="";n="link"===t?e.target.href:e.target.src;var r=new k("RESOURCE_LOAD",n,t,"0");r.handleLogInfo("RESOURCE_LOAD",r);var o=localStorage.RESOURCE_LOAD;o.length>0&&this.report(JSON.parse(o),"RESOURCE_LOAD")}}.bind(this),!0)},recordPV:function(){localStorage.monitorPageKey=x();var e="load";this.resourcesObj&&(e=this.resourcesObj[0]&&"navigate"===this.resourcesObj[0].type?"load":"reload");var t=new j("CUSTOMER_PV",e,0);t.handleLogInfo("CUSTOMER_PV",t)},recordLoadPage:function(){var e,t;e=function(){setTimeout(function(){if(this.resourcesObj){var e="load";e=this.resourcesObj[0]&&"navigate"===this.resourcesObj[0].type?"load":"reload";var t=this.timingObj,n=new C("LOAD_PAGE");n.loadType=e,n.loadPage=t.loadEventEnd-t.navigationStart,n.domReady=t.domComplete-t.responseEnd,n.redirect=t.redirectEnd-t.redirectStart,n.lookupDomain=t.domainLookupEnd-t.domainLookupStart,n.ttfb=t.responseStart-t.navigationStart,n.request=t.responseEnd-t.requestStart,n.loadEvent=t.loadEventEnd-t.loadEventStart,n.appcache=t.domainLookupStart-t.fetchStart,n.unloadEvent=t.unloadEventEnd-t.unloadEventStart,n.connect=t.connectEnd-t.connectStart,n.handleLogInfo("LOAD_PAGE",n)}this.performanceGetEntries()}.bind(this),1e3)}.bind(this),t=window.onload,"function"!=typeof window.onload?window.onload=e:window.onload=function(){t(),e()}},performanceGetEntries:function(){if(window.performance&&"function"==typeof window.performance.getEntries){for(var e=window.performance.getEntries(),t=e.filter(function(e){return"script"===e.initiatorType}),n=e.filter(function(e){return"link"===e.initiatorType}),r=[],o=document.getElementsByName("script"),i=0;i<o.length;i++)o[i].src&&r.push(o[i].src);for(var a=r.filter(function(e){for(var n=!0,r=0;r<t.length;r++)if(t[r].name===e){n=!1;break}return n}),s=[],c=document.getElementsByTagName("link"),u=0;u<c.length;u++)c[u].href&&s.push(c[u].href);for(var l=s.filter(function(e){for(var t=!0,r=0;r<n.length;r++)if(n[r].name===e){t=!1;break}return t}),p=0;p<a.length;p++){var f=new k("RESOURCE_LOAD",a[p],"script","0");f.handleLogInfo("RESOURCE_LOAD",f)}for(var d=0;d<l.length;d++){var b=new k("RESOURCE_LOAD",l[d],"link","0");b.handleLogInfo("RESOURCE_LOAD",b)}}},recordBehavior:function(e){e&&e.record&&1==e.record&&(this.checkUrlChange(),document.onclick=function(e){var t="",n="",r="",o=e.target.tagName,i="";"svg"!=e.target.tagName&&"use"!=e.target.tagName&&(t=e.target.className,n=e.target.placeholder||"",r=e.target.value||"",(i=e.target.innerText?e.target.innerText.replace(/\s*/g,""):"").length>200&&(i=i.substring(0,100)+"... ..."+i.substring(i.length-99,i=i.replace(/\s/g,""))));var a=new M("ELE_BEHAVIOR","click",t,n,r,o,i);a.handleLogInfo("ELE_BEHAVIOR",a)})},siftAndMakeUpMessage:function(e,t,n,r,o,i){this.checkUrlChange();var a=t||"",s=i||"",c="";c&&(c="string"==typeof s?s.split(":")[0].replace('"',""):JSON.stringify(s).split(":")[0].replace('"',""));var u=new T("JS_ERROR",e,c+":"+a,s);u.handleLogInfo("JS_ERROR",u);var l=localStorage.JS_ERROR;l.length>0&&this.report(JSON.parse(l),"JS_ERROR")},checkUrlChange:function(){var e=window.location.href.split("?")[0].replace("#","");this.defaultLocation!=e&&(this.recordPV(),this.defaultLocation=e)},recordJavaScriptError:function(){var e=console.error;console.error=function(t){var n=arguments[0]&&arguments[0].message||t,r=0,o=0,i=arguments[0]&&arguments[0].stack;return i?this.siftAndMakeUpMessage("console_error",n,y,r,o,i):this.siftAndMakeUpMessage("console_error",n,y,r,o,"CustomizeError"+n),e.apply(console,arguments)}.bind(this),window.onerror=function(e,t,n,r,o){if("ResizeObserver loop limit exceeded"!==e){this.jsMonitorStarted=!0;var i=o?o.stack:null;this.siftAndMakeUpMessage("on_error",e,t,n,r,i)}}.bind(this),window.onunhandledrejection=function(e){var t="",n="";"object"===o()(e.reason)?(t=e.reason.message,n=e.reason.stack):(t=e.reason,n=""),this.siftAndMakeUpMessage("on_error",t,y,0,0,"UncaughtInPromiseError: "+n)}.bind(this)},ajaxEventTrigger:function(e){var t=new CustomEvent(e,{detail:this});window.dispatchEvent(t)},newXHR:function(){var e=new(0,window.XMLHttpRequest),t=this;return e.addEventListener("abort",function(){t.ajaxEventTrigger.call(this,"ajaxAbort")},!1),e.addEventListener("error",function(){t.ajaxEventTrigger.call(this,"ajaxError")},!1),e.addEventListener("load",function(){t.ajaxEventTrigger.call(this,"ajaxLoad")},!1),e.addEventListener("loadstart",function(){t.ajaxEventTrigger.call(this,"ajaxLoadStart")},!1),e.addEventListener("progress",function(){t.ajaxEventTrigger.call(this,"ajaxProgress")},!1),e.addEventListener("timeout",function(){t.ajaxEventTrigger.call(this,"ajaxTimeout")},!1),e.addEventListener("loadend",function(){t.ajaxEventTrigger.call(this,"ajaxLoadEnd")},!1),e.addEventListener("readystatechange",function(){t.ajaxEventTrigger.call(this,"ajaxReadyStateChange")},!1),e},recordHttpLog:function(){var e=[];window.XMLHttpRequest=this.newXHR,window.addEventListener("ajaxLoadStart",function(t){var n={timeStamp:(new Date).getTime(),event:t};e.push(n)}),window.addEventListener("ajaxLoadEnd",function(){for(var t=0;t<e.length;t++)if(e[t].event.detail.status>0){var n=(new Date).getTime(),r=e[t].event.detail.responseURL,o=e[t].event.detail.statusText,i=n-e[t].timeStamp;if(!r||r&&-1!=r.indexOf(reportHost))return;var a=new P("HTTP_LOG",r,o,statusText,"发起请求",e[t].timeStamp,0);a.handleLogInfo("HTTP_LOG",a);var s=new P("HTTP_LOG",r,o,statusText,"请求返回",n,i);s.handleLogInfo("HTTP_LOG",s),e.splice(t,1)}})},report:function(e,t){!function(e,t,n,r,o,i){var a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");for(var s in a.open(e,t,!0),a.setRequestHeader("Content-Type","application/json"),n)a.setRequestHeader(s,n[s]);a.setRequestHeader("X-Custom-Header","value"),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=JSON.parse(a.responseText);"function"==typeof o&&o(e)}else"function"==typeof i&&i()},a.send(JSON.stringify(r))}("POST",this.getReportHost()+"/log/collect/uploadErrorLog",{appname:this.getReportAppName()||"xddpc",client_type:this.getReportClientType()||"pc",content_format:"json"},[{context:JSON.stringify(e),detail:e.detail,errorType:"RESOURCE_LOAD"===t?"network_exception":"syntax_error",name:"RESOURCE_LOAD"===t?"资源出错":"JS出错",params:"",status:"",timestamp:R((new Date).getTime()),userId:"11111111"}],function(){localStorage[t]=""},function(){})},setReportHost:function(e){this.reportHost=e},getReportHost:function(){return this.reportHost},setReportAppName:function(e){this.reportAppName=e},getReportAppName:function(){return this.reportAppName},setReportClientType:function(e){this.reportClientType=e},getReportClientType:function(){return this.reportClientType},reportHost:"",reportAppName:"",reportClientType:"",init:function(e){var t=e.host,n=void 0===t?"https://logCollect-api.cs.kemai.com.cn":t,r=e.appAame,o=void 0===r?"xddpc":r,i=e.clientType,a=void 0===i?"pc":i;this.setReportHost(n),this.setReportAppName(o),this.setReportClientType(a),localStorage||(window.localStorage=new Object),localStorage.kmUserInfo="",this.fetchHttpUrl=null,this.webMonitorUploadTimer=null,this.uploadMessageArray=null,this.jsMonitorStarted=!1,this.uploadRemoteServer=!0,this.screenShotDescriptions=[],this.tempScreenShot="",this.defaultLocation=window.location.href.split("?")[0].replace("#",""),this.timingObj=performance&&performance.timing,this.resourcesObj=performance&&"function"==typeof performance.getEntries?performance.getEntries():null;try{this.recordResourceError(),this.recordJavaScriptError()}catch(e){console.error("监控代码异常，捕获",e)}}}}])});