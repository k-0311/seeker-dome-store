## 科脉web前端监控上报系统

### 说明

怎样定位前端线上问题，一直以来，都是很头疼的问题，因为它发生于用户的一系列操作之后。错误的原因可能源于机型，网络环境，复杂的操作行为等等，在我们想要去解决的时候很难复现出来，自然也就无法解决。

### 上报功能列表

- [x] 1. 前端异常上报
- [ ] 2. 用户PV/UV统计
- [ ] 3. 页面加载时间统计
- [ ] 4. 用户点击行为统计
- [ ] 5. 接口请求日志统计
- [ ] 6. 接口请求耗时统计
- [x] 7. 静态资源加载异常统计
- [ ] 8. 实现JS页面截图
- [x] 9. 自定义日志上传

### 使用方法

- 第一步：安装`km-web-monitor`包，安装命令如下：

   `npm install --save-dev git+ssh://git@km-git1.kemai.cn:zhuanghongbin/km-web-monitor.git#1.0.16`
    建议使用 cnpm 进行下载

- 第二步：全局引入包名，支持COMMONJS、ES6、AMDt等方式引入，如下：

   **es6 方式**

  ```
    import kmMonitor from 'km-web-monitor'
  ```
   **COMMONJS方式**

```
    var kmMonitor=require('km-web-monitor')
```
    

- 第三步：使用

    ```
        // 全局监控
        kmMonitor.init()
        //自定监控
        km.report(info, strType)
    ```

### 支持方法

| 方法名 | 说明                                               | 参数                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------ | -------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| init   | 初始化全局监控，目前只支持js错误监控和静态资源监控 | 接收一个对象obj,对象属性如下：{host:'', // 上报地址，默认地址https://logCollect-api.cs.kemai.com.cn client_type:'', //客户端类型，默认值是pc appAame:'xddpc' //客户端名称，默认值是xddpc   }                                                                                                                                                                                                                                                                                             |
| report | 自定义上传                                         | 接收两个参数，两参数分别是info, strType；注意这两个参数都是必填项，info是一个对象参数，对象属性如下：{deviceName:'' //  选填，设备名称,os:'' //选填，系统名称,browserName:''  //  选填，浏览器名称,browserVersion:'' // 选填，浏览器版本,detail:''  //必填，错误信息,client_type:'pc', // 客户端类型 appname:'appname' // 客户端名称} }，strType是上报类型字符串，参数：ELE_BEHAVIOR, JS_ERROR(js错误), HTTP_LOG, SCREEN_SHOT, CUSTOMER_PV, LOAD_PAGE, RESOURCE_LOAD, CUSTOMIZE_BEHAVIOR |




### 更新记录

##### 2019-07-26

1. 增加默认用户id

##### 2019-07-05

1. 补充功能
2. 增加文档说明

##### 2019-06-19  

1. 第一个次提交